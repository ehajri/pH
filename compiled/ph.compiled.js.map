{"version":3,"sources":["src/node_modules/browser-pack/_prelude.js","src/src/ph.js","src/ph.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","routes","m","prop","sections","Object","create","parentmenu","view","ctrl","args","class","data-toggle","data-hover","data-close-others","submenu","subs","map","sub","renderAsMenu","href","route","config","header","lonemenu","dropdownmenu","component","nav","R","keys","section","sec","authorized","_claims","has","AddRoute","Section","equals","type","id","this","name","message","assign","prototype","AddModule","push","filter","claims","flatten","pH","concat","required","requiredaslist","contains","value","intersection","GetRoutes","reduce","v","merge","document","addEventListener","pHObj","SetClaims","Routes","AddSection","InitMenu","node","mount","getElementById","InitRoute","From","console","log","JSON","stringify","window"],"mappings":"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","file":"src/ph.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\r\n * Created by Ebrahem on 7/7/2016.\r\n */\r\n\r\n(function() {\r\n\r\n    var routes = m.prop({});\r\n\r\n    var sections = Object.create(null);\r\n\r\n    var parentmenu = {\r\n        view: function(ctrl, args) {\r\n            return (\r\n            m('a', {class: '', 'data-toggle': 'dropdown', 'data-hover': 'megamenu-dropdown', 'data-close-others': 'true' },\r\n                [\r\n                    args,\r\n                    m('i.fa.fa-angle-down')\r\n                ])\r\n            );\r\n        }\r\n    };\r\n    var submenu = {\r\n        view: function(ctrl, subs) {\r\n            return (\r\n            m('ul', {class: 'dropdown-menu pull-left'},\r\n                [\r\n                    subs.map(function(sub) {return sub.renderAsMenu === false ? null : (\r\n                        m('li',\r\n                            m('a', {\r\n                                href: sub.route,\r\n                                config: m.route\r\n                            }\r\n                            , m('i.fa.fa-cubes')\r\n                            , ' ' + sub.header)\r\n                        ));})\r\n            ])\r\n            );\r\n        }\r\n    };\r\n    var lonemenu = {\r\n        view: function(ctrl, args) {\r\n            return (\r\n                m('li',\r\n                    m('a', {\r\n                        href: args.route,\r\n                        config: m.route\r\n                    }, args.header)\r\n                )\r\n            );\r\n        }\r\n    };\r\n    var dropdownmenu = {\r\n      view: function(ctrl, args) {\r\n          return (\r\n              m('li', {class: 'menu-dropdown classic-menu-dropdown'},\r\n              [\r\n                  m.component(parentmenu, args.header),\r\n                  m.component(submenu, args.sub)\r\n              ])\r\n          );\r\n      }\r\n    };\r\n\r\n    var nav = {\r\n        view: function() {\r\n            return (\r\n            R.keys(sections).map(function(section) {\r\n                var sec = sections[section];\r\n                if (!authorized(_claims, sec)) { return; }\r\n                return (\r\n                    R.has('sub')(sec) && sec.sub.length > 0 ?\r\n                    m.component(dropdownmenu, {header: sec.header, sub: sec.sub})\r\n                    :\r\n                    m.component(lonemenu, {header: sec.header, route: sec.route || ''})\r\n                );\r\n            }));\r\n        }\r\n    };\r\n\r\n    var AddRoute = function(route, component) {\r\n        routes()[route] = component;\r\n    };\r\n\r\n    var Section = function(section) {\r\n        if (R.equals(R.type(section), 'Object')) {\r\n            var id = this.id = section.id || section.header;\r\n            if (!R.has(id)(sections)) {\r\n                //copy properties over to this\r\n                Object.assign(this, section);\r\n                sections[id] = this;\r\n                AddRoute(section.route, section);\r\n            } else {\r\n                throw new Error({name: 'Section Error', message: 'Section \"' + id + '\" does exist!'});\r\n            }\r\n        } else {\r\n            if (!R.has(section)(sections)) {\r\n                sections[section] = this;\r\n            } else {\r\n                throw new Error({name: 'Section Error', message: 'Section \"' + section + '\" does exist!'});\r\n            }\r\n            this.id = this.header = section;\r\n        }\r\n    };\r\n\r\n    Section.prototype.AddModule = function (module) {\r\n        if (!R.has('sub')(this)) {\r\n            this['sub'] = [];\r\n        }\r\n\r\n        this['sub'].push(module);\r\n\r\n        AddRoute(module.route, module);\r\n        return this;\r\n    };\r\n\r\n    var filter = function(claims) {\r\n        return R.flatten(\r\n            R.keys(sections).map(\r\n                function(t) {\r\n                    var s = pH.sections[t];\r\n                    return s.sub ? [].concat(s, s.sub) : s;\r\n                }\r\n            )\r\n        ).filter(\r\n            function(r) {\r\n                return authorized(claims, r);\r\n            }\r\n        );\r\n    };\r\n\r\n    var authorized = function(claims, component) {\r\n        var required = component.claims,\r\n            requiredaslist = R.equals(R.type(required), 'Object') ? [required] : required;\r\n        return R.contains({type: 'Type', value: 'Administrator'}, claims) ||\r\n            (R.has('claims')(component) && (\r\n                R.equals({type: 'Type', value: 'any'}, required) ||\r\n\r\n                R.intersection(claims, requiredaslist).length > 0\r\n            ));\r\n    };\r\n\r\n    var GetRoutes = function() {\r\n        return R.reduce(\r\n            function(o, v) {\r\n                var a = {};\r\n                a[v.route] = v;\r\n                return R.merge(o, a);\r\n            },\r\n            {},\r\n            pH.filter(_claims)\r\n        );\r\n    };\r\n\r\n    var _claims = [];\r\n\r\n\r\n    document.addEventListener('DOMContentLoaded', function(e) {\r\n        //m.mount(document.getElementById'main'), AccModule1);\r\n        //m.mount(document.getElementById('nav'), nav);\r\n        //m.route(document.getElementById('main'), '/', GetRoutes());\r\n    });\r\n\r\n    var pHObj = {\r\n        SetClaims: function(claims) {\r\n            _claims = claims;\r\n        },\r\n        filter: filter,\r\n        sections: sections,\r\n        Routes: routes(),\r\n        AddSection: function(section) {\r\n            return new Section(section);\r\n        },\r\n        InitMenu: function(node) {\r\n            m.mount(document.getElementById(node), nav);\r\n        },\r\n        InitRoute: function(node) {\r\n            m.route(document.getElementById(node), '/', GetRoutes());\r\n        },\r\n        From: function(section) {\r\n            var header;\r\n            if (section instanceof Section) {\r\n                header = section.id;\r\n            } else if(R.equals(R.type(section), 'String')) {\r\n                header = section;\r\n            } else if(R.equals(R.type(section), 'Object')) {\r\n                header = section.id;\r\n            }\r\n\r\n            if (R.has(header)(sections)) {\r\n                return sections[header];\r\n            }\r\n\r\n            console.log('Throwing error', JSON.stringify(section));\r\n            throw new Error({name: 'From Error', message: 'Unknown section, args:'});\r\n        }\r\n    };\r\n    window.pH = pHObj;\r\n})();\r\n\r\n\r\n\r\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/**\r\n * Created by Ebrahem on 7/7/2016.\r\n */\r\n\r\n(function() {\r\n\r\n    var routes = m.prop({});\r\n\r\n    var sections = Object.create(null);\r\n\r\n    var parentmenu = {\r\n        view: function(ctrl, args) {\r\n            return (\r\n            m('a', {class: '', 'data-toggle': 'dropdown', 'data-hover': 'megamenu-dropdown', 'data-close-others': 'true' },\r\n                [\r\n                    args,\r\n                    m('i.fa.fa-angle-down')\r\n                ])\r\n            );\r\n        }\r\n    };\r\n    var submenu = {\r\n        view: function(ctrl, subs) {\r\n            return (\r\n            m('ul', {class: 'dropdown-menu pull-left'},\r\n                [\r\n                    subs.map(function(sub) {return sub.renderAsMenu === false ? null : (\r\n                        m('li',\r\n                            m('a', {\r\n                                href: sub.route,\r\n                                config: m.route\r\n                            }\r\n                            , m('i.fa.fa-cubes')\r\n                            , ' ' + sub.header)\r\n                        ));})\r\n            ])\r\n            );\r\n        }\r\n    };\r\n    var lonemenu = {\r\n        view: function(ctrl, args) {\r\n            return (\r\n                m('li',\r\n                    m('a', {\r\n                        href: args.route,\r\n                        config: m.route\r\n                    }, args.header)\r\n                )\r\n            );\r\n        }\r\n    };\r\n    var dropdownmenu = {\r\n      view: function(ctrl, args) {\r\n          return (\r\n              m('li', {class: 'menu-dropdown classic-menu-dropdown'},\r\n              [\r\n                  m.component(parentmenu, args.header),\r\n                  m.component(submenu, args.sub)\r\n              ])\r\n          );\r\n      }\r\n    };\r\n\r\n    var nav = {\r\n        view: function() {\r\n            return (\r\n            R.keys(sections).map(function(section) {\r\n                var sec = sections[section];\r\n                if (!authorized(_claims, sec)) { return; }\r\n                return (\r\n                    R.has('sub')(sec) && sec.sub.length > 0 ?\r\n                    m.component(dropdownmenu, {header: sec.header, sub: sec.sub})\r\n                    :\r\n                    m.component(lonemenu, {header: sec.header, route: sec.route || ''})\r\n                );\r\n            }));\r\n        }\r\n    };\r\n\r\n    var AddRoute = function(route, component) {\r\n        routes()[route] = component;\r\n    };\r\n\r\n    var Section = function(section) {\r\n        if (R.equals(R.type(section), 'Object')) {\r\n            var id = this.id = section.id || section.header;\r\n            if (!R.has(id)(sections)) {\r\n                //copy properties over to this\r\n                Object.assign(this, section);\r\n                sections[id] = this;\r\n                AddRoute(section.route, section);\r\n            } else {\r\n                throw new Error({name: 'Section Error', message: 'Section \"' + id + '\" does exist!'});\r\n            }\r\n        } else {\r\n            if (!R.has(section)(sections)) {\r\n                sections[section] = this;\r\n            } else {\r\n                throw new Error({name: 'Section Error', message: 'Section \"' + section + '\" does exist!'});\r\n            }\r\n            this.id = this.header = section;\r\n        }\r\n    };\r\n\r\n    Section.prototype.AddModule = function (module) {\r\n        if (!R.has('sub')(this)) {\r\n            this['sub'] = [];\r\n        }\r\n\r\n        this['sub'].push(module);\r\n\r\n        AddRoute(module.route, module);\r\n        return this;\r\n    };\r\n\r\n    var filter = function(claims) {\r\n        return R.flatten(\r\n            R.keys(sections).map(\r\n                function(t) {\r\n                    var s = pH.sections[t];\r\n                    return s.sub ? [].concat(s, s.sub) : s;\r\n                }\r\n            )\r\n        ).filter(\r\n            function(r) {\r\n                return authorized(claims, r);\r\n            }\r\n        );\r\n    };\r\n\r\n    var authorized = function(claims, component) {\r\n        var required = component.claims,\r\n            requiredaslist = R.equals(R.type(required), 'Object') ? [required] : required;\r\n        return R.contains({type: 'Type', value: 'Administrator'}, claims) ||\r\n            (R.has('claims')(component) && (\r\n                R.equals({type: 'Type', value: 'any'}, required) ||\r\n\r\n                R.intersection(claims, requiredaslist).length > 0\r\n            ));\r\n    };\r\n\r\n    var GetRoutes = function() {\r\n        return R.reduce(\r\n            function(o, v) {\r\n                var a = {};\r\n                a[v.route] = v;\r\n                return R.merge(o, a);\r\n            },\r\n            {},\r\n            pH.filter(_claims)\r\n        );\r\n    };\r\n\r\n    var _claims = [];\r\n\r\n\r\n    document.addEventListener('DOMContentLoaded', function(e) {\r\n        //m.mount(document.getElementById'main'), AccModule1);\r\n        //m.mount(document.getElementById('nav'), nav);\r\n        //m.route(document.getElementById('main'), '/', GetRoutes());\r\n    });\r\n\r\n    var pHObj = {\r\n        SetClaims: function(claims) {\r\n            _claims = claims;\r\n        },\r\n        filter: filter,\r\n        sections: sections,\r\n        Routes: routes(),\r\n        AddSection: function(section) {\r\n            return new Section(section);\r\n        },\r\n        InitMenu: function(node) {\r\n            m.mount(document.getElementById(node), nav);\r\n        },\r\n        InitRoute: function(node) {\r\n            m.route(document.getElementById(node), '/', GetRoutes());\r\n        },\r\n        From: function(section) {\r\n            var header;\r\n            if (section instanceof Section) {\r\n                header = section.id;\r\n            } else if(R.equals(R.type(section), 'String')) {\r\n                header = section;\r\n            } else if(R.equals(R.type(section), 'Object')) {\r\n                header = section.id;\r\n            }\r\n\r\n            if (R.has(header)(sections)) {\r\n                return sections[header];\r\n            }\r\n\r\n            console.log('Throwing error', JSON.stringify(section));\r\n            throw new Error({name: 'From Error', message: 'Unknown section, args:'});\r\n        }\r\n    };\r\n    window.pH = pHObj;\r\n})();\r\n\r\n\r\n\r\n\n},{}]},{},[1])\n\n"],"sourceRoot":"/source/"}